import datetime
from bson.objectid import ObjectId
from pprint import pprint

duplicates = [{'_id': ObjectId('62a995f7e600e8adf41d9df8'), 'scenario_uuid': '24cdf047-d2ad-4425-8c96-04021ab610e6',
               'kpi_status': 'pass',
               'test_run_id': '1653055316200-02a4b4e3fdcf7173c-f04136c3-4d9e-4d12-b30f-089a53277645|i-02a4b4e3fdcf7173c',
               'cad_topology_job_uuid': 'b5ca4ccf-e316-49e0-8b9b-8c2f298851bd', 'bench_id': 1,
               'bench_name': 'Carla_Bench_1', 'scenario_group_name': '20_05_2022_20k_test_34', 'scenario_group_id': 993,
               'created_at': datetime.datetime(2022, 6, 15, 8, 19, 1, 281000),
               'updated_at': datetime.datetime(2022, 6, 15, 8, 19, 3, 789000)},
              {'_id': ObjectId('62a995fa299c5388da256d7c'), 'scenario_uuid': '289f4280-e1a0-4ed6-8470-7e1045214521',
               'kpi_status': 'pass',
               'test_run_id': '1653055316200-02a4b4e3fdcf7173c-f04136c3-4d9e-4d12-b30f-089a53277645|i-02a4b4e3fdcf7173c',
               'cad_topology_job_uuid': 'b5ca4ccf-e316-49e0-8b9b-8c2f298851bd', 'bench_id': 1,
               'bench_name': 'Carla_Bench_1', 'scenario_group_name': '20_05_2022_20k_test_34', 'scenario_group_id': 993,
               'created_at': datetime.datetime(2022, 6, 15, 8, 19, 3, 660000),
               'updated_at': datetime.datetime(2022, 6, 15, 8, 19, 6, 240000)},
              {'_id': ObjectId('62a995fbe600e8adf41d9dfa'), 'scenario_uuid': '24cdf047-d2ad-4425-8c96-04021ab610e6',
               'kpi_status': 'pass',
               'test_run_id': '1653055316200-02a4b4e3fdcf7173c-f04136c3-4d9e-4d12-b30f-089a53277645|i-02a4b4e3fdcf7173c',
               'cad_topology_job_uuid': 'b5ca4ccf-e316-49e0-8b9b-8c2f298851bd', 'bench_id': 1,
               'bench_name': 'Carla_Bench_1', 'scenario_group_name': '20_05_2022_20k_test_34', 'scenario_group_id': 993,
               'created_at': datetime.datetime(2022, 6, 15, 8, 19, 5, 273000),
               'updated_at': datetime.datetime(2022, 6, 15, 8, 19, 7, 569000)},
              {'_id': ObjectId('62a995fcb6ef06fd2f186851'), 'scenario_uuid': '289f4280-e1a0-4ed6-8470-7e1045214521',
               'kpi_status': 'pass',
               'test_run_id': '1653055316200-02a4b4e3fdcf7173c-f04136c3-4d9e-4d12-b30f-089a53277645|i-02a4b4e3fdcf7173c',
               'cad_topology_job_uuid': 'b5ca4ccf-e316-49e0-8b9b-8c2f298851bd', 'bench_id': 1,
               'bench_name': 'Carla_Bench_1', 'scenario_group_name': '20_05_2022_20k_test_34', 'scenario_group_id': 993,
               'created_at': datetime.datetime(2022, 6, 15, 8, 19, 5, 916000),
               'updated_at': datetime.datetime(2022, 6, 15, 8, 19, 8, 515000)},
              {'_id': ObjectId('62a995fc299c5388da256d7e'), 'scenario_uuid': '5acb61dd-ea42-4bba-82ad-1d85b6e36dcb',
               'kpi_status': 'pass',
               'test_run_id': '1653055316200-02a4b4e3fdcf7173c-f04136c3-4d9e-4d12-b30f-089a53277645|i-02a4b4e3fdcf7173c',
               'cad_topology_job_uuid': 'b5ca4ccf-e316-49e0-8b9b-8c2f298851bd', 'bench_id': 1,
               'bench_name': 'Carla_Bench_1', 'scenario_group_name': '20_05_2022_20k_test_34', 'scenario_group_id': 993,
               'created_at': datetime.datetime(2022, 6, 15, 8, 19, 6, 261000),
               'updated_at': datetime.datetime(2022, 6, 15, 8, 19, 8, 761000)},
              {'_id': ObjectId('62a99600c145ee977000a599'), 'scenario_uuid': '5acb61dd-ea42-4bba-82ad-1d85b6e36dcb',
               'kpi_status': 'pass',
               'test_run_id': '1653055316200-02a4b4e3fdcf7173c-f04136c3-4d9e-4d12-b30f-089a53277645|i-02a4b4e3fdcf7173c',
               'cad_topology_job_uuid': 'b5ca4ccf-e316-49e0-8b9b-8c2f298851bd', 'bench_id': 1,
               'bench_name': 'Carla_Bench_1', 'scenario_group_name': '20_05_2022_20k_test_34', 'scenario_group_id': 993,
               'created_at': datetime.datetime(2022, 6, 15, 8, 19, 8, 840000),
               'updated_at': datetime.datetime(2022, 6, 15, 8, 19, 12, 225000)},
              {'_id': ObjectId('62a9ac5560c8f913f06d6185'), 'scenario_uuid': 'cce6351d-1be7-4c2e-b818-47bb40e01dbe',
               'kpi_status': 'pass',
               'test_run_id': '1653055457895-099ed289c0e42772d-717d28ae-8cb5-444a-8e7a-c720dae4b464|i-099ed289c0e42772d',
               'cad_topology_job_uuid': 'b5ca4ccf-e316-49e0-8b9b-8c2f298851bd', 'bench_id': 1,
               'bench_name': 'Carla_Bench_1', 'scenario_group_name': '20_05_2022_20k_test_103',
               'scenario_group_id': 1062, 'created_at': datetime.datetime(2022, 6, 15, 9, 54, 28, 846000),
               'updated_at': datetime.datetime(2022, 6, 15, 9, 54, 29, 154000)},
              {'_id': ObjectId('62a9ac5660c8f913f06d6187'), 'scenario_uuid': '6fefd03c-c397-4a27-a377-9fd50435f59f',
               'kpi_status': 'pass',
               'test_run_id': '1653055457895-099ed289c0e42772d-717d28ae-8cb5-444a-8e7a-c720dae4b464|i-099ed289c0e42772d',
               'cad_topology_job_uuid': 'b5ca4ccf-e316-49e0-8b9b-8c2f298851bd', 'bench_id': 1,
               'bench_name': 'Carla_Bench_1', 'scenario_group_name': '20_05_2022_20k_test_103',
               'scenario_group_id': 1062, 'created_at': datetime.datetime(2022, 6, 15, 9, 54, 30, 19000),
               'updated_at': datetime.datetime(2022, 6, 15, 9, 54, 30, 329000)},
              {'_id': ObjectId('62a9ac5760c8f913f06d6189'), 'scenario_uuid': 'cce6351d-1be7-4c2e-b818-47bb40e01dbe',
               'kpi_status': 'pass',
               'test_run_id': '1653055457895-099ed289c0e42772d-717d28ae-8cb5-444a-8e7a-c720dae4b464|i-099ed289c0e42772d',
               'cad_topology_job_uuid': 'b5ca4ccf-e316-49e0-8b9b-8c2f298851bd', 'bench_id': 1,
               'bench_name': 'Carla_Bench_1', 'scenario_group_name': '20_05_2022_20k_test_103',
               'scenario_group_id': 1062, 'created_at': datetime.datetime(2022, 6, 15, 9, 54, 30, 841000),
               'updated_at': datetime.datetime(2022, 6, 15, 9, 54, 31, 152000)},
              {'_id': ObjectId('62a9ac57c145ee977000ad19'), 'scenario_uuid': '6fefd03c-c397-4a27-a377-9fd50435f59f',
               'kpi_status': 'pass',
               'test_run_id': '1653055457895-099ed289c0e42772d-717d28ae-8cb5-444a-8e7a-c720dae4b464|i-099ed289c0e42772d',
               'cad_topology_job_uuid': 'b5ca4ccf-e316-49e0-8b9b-8c2f298851bd', 'bench_id': 1,
               'bench_name': 'Carla_Bench_1', 'scenario_group_name': '20_05_2022_20k_test_103',
               'scenario_group_id': 1062, 'created_at': datetime.datetime(2022, 6, 15, 9, 54, 31, 124000),
               'updated_at': datetime.datetime(2022, 6, 15, 9, 54, 31, 511000)},
              {'_id': ObjectId('62a9ac5760c8f913f06d618b'), 'scenario_uuid': '6fb3a92b-7b3f-4c89-a2e4-b381c1d9011d',
               'kpi_status': 'pass',
               'test_run_id': '1653055457895-099ed289c0e42772d-717d28ae-8cb5-444a-8e7a-c720dae4b464|i-099ed289c0e42772d',
               'cad_topology_job_uuid': 'b5ca4ccf-e316-49e0-8b9b-8c2f298851bd', 'bench_id': 1,
               'bench_name': 'Carla_Bench_1', 'scenario_group_name': '20_05_2022_20k_test_103',
               'scenario_group_id': 1062, 'created_at': datetime.datetime(2022, 6, 15, 9, 54, 31, 311000),
               'updated_at': datetime.datetime(2022, 6, 15, 9, 54, 31, 674000)},
              {'_id': ObjectId('62a9ac571426bf480a3d9852'), 'scenario_uuid': '6fb3a92b-7b3f-4c89-a2e4-b381c1d9011d',
               'kpi_status': 'pass',
               'test_run_id': '1653055457895-099ed289c0e42772d-717d28ae-8cb5-444a-8e7a-c720dae4b464|i-099ed289c0e42772d',
               'cad_topology_job_uuid': 'b5ca4ccf-e316-49e0-8b9b-8c2f298851bd', 'bench_id': 1,
               'bench_name': 'Carla_Bench_1', 'scenario_group_name': '20_05_2022_20k_test_103',
               'scenario_group_id': 1062, 'created_at': datetime.datetime(2022, 6, 15, 9, 54, 31, 515000),
               'updated_at': datetime.datetime(2022, 6, 15, 9, 54, 31, 972000)}]
print(len(duplicates))
pprint(list(set([doc.get('scenario_uuid') for doc in duplicates])))
pprint(list(set([f"{doc.get('scenario_uuid')}-{doc.get('test_run_id')}" for doc in duplicates])))